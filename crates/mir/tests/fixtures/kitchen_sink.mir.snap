---
source: crates/mir/tests/lowering_snapshots.rs
assertion_line: 26
expression: mir_output
---
fn bump__StorPtr_Foo___3698cc3c4b2626e3(v0: u256) -> ():
  bb0:
    v1: u256 = load stor[v0].0
    store stor[v0].0 = (v1 + 1)
    v2: u256 = load stor[v0].1
    store stor[v0].1 = (v2 + 2)
    ret

fn maybe_inc(v0: Opt) -> u64:
  bb0:
    v2: u64 = 0
    jmp bb4
  bb1:
    ret 0
  bb2:
    v4: u64 = load mem[v0].1[0]
    v3: u64 = v4
    v2 = v3
    jmp bb3
  bb3:
    v1: u64 = v2
    v6: u64 = 0
    jmp bb6
  bb4:
    v5: u256 = load mem[v0].discr
    switch v5 [0 => bb1, 1 => bb2] else bb5
  bb5:
    unreachable
  bb6:
    br (v6 < 3) bb7 bb8
  bb7:
    v6 = (v6 + 1)
    jmp bb6
  bb8:
    ret (v1 + v6)

fn test_effects_and_aggregates__Evm_hef0af3106e109414_Evm_hef0af3106e109414__7ab75559784fbc59(v0: u256, v1: u256) -> ():
  bb0:
    v2: MemPtr<Foo> = mem_ptr__Evm_hef0af3106e109414_Foo_h6dbce71a6ea992b8__c09e6c6fc5a7b23d(v1, 256)
    bind v2
    eval bump__MemPtr_Foo___cdd30998d577b6ea(v2)
    v3: StorPtr<Foo> = stor_ptr__Evm_hef0af3106e109414_Foo_h6dbce71a6ea992b8__c09e6c6fc5a7b23d(v0, 0)
    bind v3
    eval bump__StorPtr_Foo___3698cc3c4b2626e3(v3)
    v5: Foo = alloc mem
    init mem[v5] { .0 = 10, .1 = 20 }
    v4: Foo = v5
    bind v4
    eval bump__MemPtr_Foo___cdd30998d577b6ea(v4)
    v6: StorPtr<StorageMap<u256, u256, 0>> = stor_ptr__Evm_hef0af3106e109414_StorageMap_u256__u256__0___25d90c867c72c521(v0, 0)
    bind v6
    eval set_balance__StorPtr_StorageMap_u256__u256__0____4a2331212cb04e60(1, 7, v6)
    v7: u256 = get_balance__StorPtr_StorageMap_u256__u256__0____4a2331212cb04e60(1, v6)
    ret

fn get_balance__StorPtr_StorageMap_u256__u256__0____4a2331212cb04e60(v0: u256, v1: u256) -> u256:
  bb0:
    v2: u256 = storagemap_k__v__const_salt__u256__h5955888dd44c2a19_get__u256_u256_0__6a346ad3c930d971(v1, v0)
    ret v2

fn set_balance__StorPtr_StorageMap_u256__u256__0____4a2331212cb04e60(v0: u256, v1: u256, v2: u256) -> ():
  bb0:
    eval storagemap_k__v__const_salt__u256__h5955888dd44c2a19_set__u256_u256_0__6a346ad3c930d971(v2, v0, v1)
    ret

fn selector_match__Evm_hef0af3106e109414__3af54274b2985741(v0: u256) -> u256:
  bb0:
    v2: u256 = calldataload(0)
    v1: u256 = (v2 >> 224)
    v3: u256 = 0
    jmp bb5
  bb1:
    v3 = 1
    jmp bb2
  bb2:
    ret v3
  bb3:
    v3 = 2
    jmp bb2
  bb4:
    v3 = 0
    jmp bb2
  bb5:
    switch v1 [151146943 => bb1, 2066295049 => bb3] else bb4

fn mem_ptr__Evm_hef0af3106e109414_Foo_h6dbce71a6ea992b8__c09e6c6fc5a7b23d(v0: Self, v1: u256) -> MemPtr<Foo>:
  bb0:
    v2: MemPtr<Foo> = memptr_t__hf71ec14ffe47fb3f_effecthandle_hfc52f915596f993a_from_raw__Foo_h6dbce71a6ea992b8__21493237fe9c2c26(v1)
    ret v2

fn bump__MemPtr_Foo___cdd30998d577b6ea(v0: u256) -> ():
  bb0:
    v1: u256 = load mem[v0].0
    store mem[v0].0 = (v1 + 1)
    v2: u256 = load mem[v0].1
    store mem[v0].1 = (v2 + 2)
    ret

fn stor_ptr__Evm_hef0af3106e109414_Foo_h6dbce71a6ea992b8__c09e6c6fc5a7b23d(v0: Self, v1: u256) -> StorPtr<Foo>:
  bb0:
    v2: StorPtr<Foo> = storptr_t__hc45dea9607fd5340_effecthandle_hfc52f915596f993a_from_raw__Foo_h6dbce71a6ea992b8__21493237fe9c2c26(v1)
    ret v2

fn stor_ptr__Evm_hef0af3106e109414_StorageMap_u256__u256__0___25d90c867c72c521(v0: Self, v1: u256) -> StorPtr<StorageMap<u256, u256, 0>>:
  bb0:
    v2: StorPtr<StorageMap<u256, u256, 0>> = storptr_t__hc45dea9607fd5340_effecthandle_hfc52f915596f993a_from_raw__Foo_h6dbce71a6ea992b8__21493237fe9c2c26(v1)
    ret v2

fn storagemap_k__v__const_salt__u256__h5955888dd44c2a19_get__u256_u256_0__6a346ad3c930d971(v0: StorageMap<K, V, const SALT: u256>, v1: K) -> u256:
  bb0:
    v2: u256 = storagemap_get_word_with_salt__u256__3271ca15373d4483(v1, 0)
    v3: u256 = u256_h3271ca15373d4483_wordrepr_h7483d41ac8178d88_from_word(v2)
    ret v3

fn storagemap_k__v__const_salt__u256__h5955888dd44c2a19_set__u256_u256_0__6a346ad3c930d971(v0: StorageMap<K, V, const SALT: u256>, v1: K, v2: V) -> ():
  bb0:
    v3: u256 = u256_h3271ca15373d4483_wordrepr_h7483d41ac8178d88_to_word(v2)
    eval storagemap_set_word_with_salt__u256__3271ca15373d4483(v1, 0, v3)
    ret

fn memptr_t__hf71ec14ffe47fb3f_effecthandle_hfc52f915596f993a_from_raw__Foo_h6dbce71a6ea992b8__21493237fe9c2c26(v0: u256) -> MemPtr<Foo>:
  bb0:
    ret v0

fn storptr_t__hc45dea9607fd5340_effecthandle_hfc52f915596f993a_from_raw__Foo_h6dbce71a6ea992b8__21493237fe9c2c26(v0: u256) -> StorPtr<Foo>:
  bb0:
    ret v0

fn storagemap_get_word_with_salt__u256__3271ca15373d4483(v0: K, v1: u256) -> u256:
  bb0:
    v2: u256 = storagemap_storage_slot_with_salt__u256__3271ca15373d4483(v0, v1)
    v3: u256 = sload(v2)
    ret v3

fn u256_h3271ca15373d4483_wordrepr_h7483d41ac8178d88_from_word(v0: u256) -> u256:
  bb0:
    ret v0

fn u256_h3271ca15373d4483_wordrepr_h7483d41ac8178d88_to_word(v0: u256) -> u256:
  bb0:
    ret v0

fn storagemap_set_word_with_salt__u256__3271ca15373d4483(v0: K, v1: u256, v2: u256) -> ():
  bb0:
    v3: u256 = storagemap_storage_slot_with_salt__u256__3271ca15373d4483(v0, v1)
    eval sstore(v3, v2)
    ret

fn storagemap_storage_slot_with_salt__u256__3271ca15373d4483(v0: K, v1: u256) -> u256:
  bb0:
    v2: u256 = mload(64)
    v3: u256 = u256_h3271ca15373d4483_storagekey_hf9e3d38a13ff4409_write_key(v2, v0)
    eval mstore((v2 + v3), v1)
    v4: u256 = keccak256(v2, (v3 + 32))
    ret v4

fn u256_h3271ca15373d4483_storagekey_hf9e3d38a13ff4409_write_key(v0: u256, v1: u256) -> u256:
  bb0:
    eval mstore(v0, v1)
    ret 32
